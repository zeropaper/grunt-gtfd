<html>

<head>
  <title>Rendering utilities</title>
  <link type="text/css" rel="stylesheet" href="../assets/styles/styles.css" />
</head>

<body>
  <header>
    <div class="row">
      
        <ul class="breadcrumb"><li>lib</li></ul>
      
    </div>
    <h1>Rendering utilities</h1>
  </header>

  <nav class="docs-nav">
  <div class="search"></div>

  <div class="toggle">Files</div>

  <ul class="directory root">
  
    <li class="index">
      <a href="../index.html">Home</a>
    </li>
  

  
    <li class="">
      
  <a href="../Gruntfile.js.html">Gruntfile.js</a>


    </li>
  
    <li class="trail">
      
  
  
    <span class="dirname">lib</span>
  

  <ul class="directory">
  

    <li class="">
      
  <a href="blocks-collection.js.html">blocks-collection.js</a>


    </li>

    

    <li class="">
      
  <a href="index.js.html">index.js</a>


    </li>

    

    <li class="active">
      
  <a href="rendering-utils.js.html">rendering-utils.js</a>


    </li>

    
  </ul>


    </li>
  
    <li class="">
      
  
  
    <span class="dirname">node_modules</span>
  

  <ul class="directory">
  

    <li class="">
      
  
  
    <a class="index" href="../node_modules/ampersand-collection/index.html">ampersand-collection</a>
  

  <ul class="directory">
  

    <li class="">
      
  <a href="../node_modules/ampersand-collection/ampersand-collection.js.html">ampersand-collection.js</a>


    </li>

    
  </ul>


    </li>

    

    <li class="">
      
  
  
    <a class="index" href="../node_modules/ampersand-model/index.html">ampersand-model</a>
  

  <ul class="directory">
  

    <li class="">
      
  <a href="../node_modules/ampersand-model/ampersand-model.js.html">ampersand-model.js</a>


    </li>

    
  </ul>


    </li>

    

    <li class="">
      
  
  
    <a class="index" href="../node_modules/faceted-search/index.html">faceted-search</a>
  

  <ul class="directory">
  

    <li class="">
      
  <a href="../node_modules/faceted-search/index.js.html">index.js</a>


    </li>

    

    <li class="">
      
  <a href="../node_modules/faceted-search/results.js.html">results.js</a>


    </li>

    

    <li class="">
      
  <a href="../node_modules/faceted-search/styles.css.html">styles.css</a>


    </li>

    
  </ul>


    </li>

    

    <li class="">
      
  
  
    <a class="index" href="../node_modules/files-collection/index.html">files-collection</a>
  

  <ul class="directory">
  

    <li class="">
      
  <a href="../node_modules/files-collection/DOCUMENTATION.md.html">DOCUMENTATION.md</a>


    </li>

    

    <li class="">
      
  <a href="../node_modules/files-collection/index.js.html">index.js</a>


    </li>

    

    <li class="">
      
  <a href="../node_modules/files-collection/node.js.html">node.js</a>


    </li>

    
  </ul>


    </li>

    
  </ul>


    </li>
  
    <li class="">
      
  
  
    <span class="dirname">resources</span>
  

  <ul class="directory">
  

    <li class="">
      
  
  
    <a class="index" href="../resources/test/index.html">test</a>
  

  <ul class="directory">
  

    <li class="">
      
  
  
    <a class="index" href="../resources/test/dir/index.html">dir</a>
  

  <ul class="directory">
  

    <li class="">
      
  
  
    <a class="index" href="../resources/test/dir/sub/index.html">sub</a>
  

  <ul class="directory">
  
  </ul>


    </li>

    
  </ul>


    </li>

    
  </ul>


    </li>

    

    <li class="">
      
  
  
    <a class="index" href="../resources/themes/index.html">themes</a>
  

  <ul class="directory">
  

    <li class="">
      
  
  
    <a class="index" href="../resources/themes/default/index.html">default</a>
  

  <ul class="directory">
  

    <li class="">
      
  <a href="../resources/themes/default/file.jst.html">file.jst</a>


    </li>

    

    <li class="">
      
  <a href="../resources/themes/default/navigation-item.jst.html">navigation-item.jst</a>


    </li>

    

    <li class="">
      
  <a href="../resources/themes/default/navigation.jst.html">navigation.jst</a>


    </li>

    

    <li class="">
      
  
  
    <span class="dirname">assets</span>
  

  <ul class="directory">
  

    <li class="">
      
  
  
    <span class="dirname">scripts</span>
  

  <ul class="directory">
  

    <li class="">
      
  <a href="../resources/themes/default/assets/scripts/scripts.src.js.html">scripts.src.js</a>


    </li>

    
  </ul>


    </li>

    

    <li class="">
      
  
  
    <span class="dirname">styles</span>
  

  <ul class="directory">
  

    <li class="">
      
  <a href="../resources/themes/default/assets/styles/styles.css.html">styles.css</a>


    </li>

    
  </ul>


    </li>

    
  </ul>


    </li>

    
  </ul>


    </li>

    
  </ul>


    </li>

    
  </ul>


    </li>
  
    <li class="">
      
  
  
    <span class="dirname">tasks</span>
  

  <ul class="directory">
  

    <li class="">
      
  <a href="../tasks/gtfd.js.html">gtfd.js</a>


    </li>

    
  </ul>


    </li>
  
  </ul>
</nav>



  <div class="container content">
    <div class="row"><div class="documentation"><p> This module provides some functions to render code and documentation.<br> You might be interested in the template <a href="../resources/themes/default/file.jst.html">file.jst</a> used to render the a HTML page.<br> The module depends on <a href="//github.com/chjj/marked"><code>marked</code></a> and <a href="//highlightjs.org"><code>highlight.js</code></a>.</p>
<h2 id="marked">marked<a class="anchor" href="#marked"></a></h2><p> The <code>marked</code> module is exported <a href="#marked-options">pre-configured</a>.</p>
<h2 id="renderer">renderer<a class="anchor" href="#renderer"></a></h2><p> The <code>renderer</code> is used to override some default <code>marked</code> rendering.<br> It is exposed on the module so that it can be used to make overrides.<br> Have a look at <a href="#extractmdtitle"><code>extractMDTitle</code></a></p>
</div><div class="code"><pre><code class="js"><span class="hljs-pi">'use strict'</span>;
<span class="hljs-comment">/* jshint node: true */</span>

<span class="hljs-keyword">var</span> _                   = <span class="hljs-built_in">require</span>(<span class="hljs-string">'underscore'</span>);
<span class="hljs-keyword">var</span> fs                  = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);
<span class="hljs-keyword">var</span> path                = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);
<span class="hljs-keyword">var</span> marked              = <span class="hljs-built_in">require</span>(<span class="hljs-string">'marked'</span>);
<span class="hljs-keyword">var</span> hljs                = <span class="hljs-built_in">require</span>(<span class="hljs-string">'highlight.js'</span>);
<span class="hljs-keyword">var</span> renderer            = <span class="hljs-keyword">new</span> marked.Renderer();
<span class="hljs-keyword">var</span> join                = path.join;
<span class="hljs-keyword">var</span> read                = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(fp)</span> </span>{
                            <span class="hljs-keyword">return</span> fs.readFileSync(fp).toString();
                          };
<span class="hljs-keyword">var</span> themePath           = path.resolve(__dirname, <span class="hljs-string">'../resources/themes/default'</span>);
<span class="hljs-keyword">var</span> navigationTemplate  = read(join(themePath, <span class="hljs-string">'navigation.jst'</span>));
<span class="hljs-keyword">var</span> itemTemplate        = read(join(themePath, <span class="hljs-string">'navigation-item.jst'</span>));



</code></pre></div></div><div class="row"><div class="documentation"><h3 id="repeatstr">repeatStr<a class="anchor" href="#repeatstr"></a></h3><p> Repeats a string a given amount of times.</p>
</div><div class="code"><pre><code class="js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">repeatStr</span><span class="hljs-params">(count, str)</span></span>{
  str = str || <span class="hljs-string">'..'</span>;
  <span class="hljs-keyword">var</span> arr = [];
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> c = <span class="hljs-number">0</span>; c &lt;= count; c++) {
    arr.push(str);
  }
  <span class="hljs-keyword">return</span> arr;
}
</code></pre></div></div><div class="row"><div class="documentation"><h3 id="escapehtml">escapeHTML<a class="anchor" href="#escapehtml"></a></h3><p> Can be used to replace HTML entities in a string.</p>
</div><div class="code"><pre><code class="js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">escapeHTML</span><span class="hljs-params">(str)</span> </span>{
  <span class="hljs-keyword">return</span> str.replace(<span class="hljs-regexp">/&amp;/g</span>, <span class="hljs-string">'&amp;amp;'</span>)
            .replace(<span class="hljs-regexp">/&lt;/g</span>, <span class="hljs-string">'&amp;lt;'</span>)
            .replace(<span class="hljs-regexp">/&gt;/g</span>, <span class="hljs-string">'&amp;gt;'</span>);
}
</code></pre></div></div><div class="row"><div class="documentation"><h2 id="highlight">highlight<a class="anchor" href="#highlight"></a></h2><p> Will return highlighted code if lang is known to <a href="//highlightjs.org">highlight.js</a>.<br> When not, the code will only be escaped.<br> The returned string, when not empty, is wrapped with a <code>pre</code> and a <code>code</code> elements.</p>
</div><div class="code"><pre><code class="js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">highlight</span><span class="hljs-params">(code, lang)</span> </span>{
  <span class="hljs-keyword">var</span> str;
  <span class="hljs-keyword">if</span> (!lang || !hljs.getLanguage(lang)) {
    str = escapeHTML(code);
  }
  <span class="hljs-keyword">else</span> {
    str = hljs.highlight(lang, code).value;
  }

  str = str ? (<span class="hljs-string">'&lt;pre&gt;&lt;code class="'</span> + lang + <span class="hljs-string">'"&gt;'</span> + str + <span class="hljs-string">'&lt;/code&gt;&lt;/pre&gt;'</span>) : <span class="hljs-string">''</span>;

  <span class="hljs-keyword">return</span> str;
}
</code></pre></div></div><div class="row"><div class="documentation"><h3 id="islocallink">isLocalLink<a class="anchor" href="#islocallink"></a></h3><p> Determines if a href is an external URL or referencing a project file.<br> A anchor href (starting with <code>#</code>) returns false.</p>
</div><div class="code"><pre><code class="js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isLocalLink</span><span class="hljs-params">(href)</span> </span>{
  <span class="hljs-keyword">return</span> (
            href.slice(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>) === <span class="hljs-string">'./'</span> ||
            href.slice(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>) === <span class="hljs-string">'../'</span> ||
            href.indexOf(<span class="hljs-string">'://'</span>) &lt; <span class="hljs-number">0</span>
          ) &amp;&amp;
          href[<span class="hljs-number">0</span>] !== <span class="hljs-string">'#'</span> &amp;&amp;
          href.slice(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>) !== <span class="hljs-string">'//'</span>
          ;
}
</code></pre></div></div><div class="row"><div class="documentation"><h3 id="locallink">localLink<a class="anchor" href="#locallink"></a></h3><p> Appends a <code>.html</code> to the href before first <code>#</code> (if any) but not when starting with <code>#</code>.</p>
</div><div class="code"><pre><code class="js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">localLink</span><span class="hljs-params">(href)</span> </span>{
  <span class="hljs-keyword">var</span> parts = href.split(<span class="hljs-string">'#'</span>);
  <span class="hljs-keyword">if</span> (!parts[<span class="hljs-number">0</span>]) {
    <span class="hljs-keyword">return</span> href;
  }
  parts[<span class="hljs-number">0</span>] = parts[<span class="hljs-number">0</span>] + <span class="hljs-string">'.html'</span>;
  <span class="hljs-keyword">return</span> parts.join(<span class="hljs-string">'#'</span>);
}




</code></pre></div></div><div class="row"><div class="documentation"><h2 id="renderer-link">renderer.link<a class="anchor" href="#renderer-link"></a></h2><p> Ensure a <code>.html</code> is append to project file paths in the rendered markdown.</p>
</div><div class="code"><pre><code class="js">renderer.link = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(href, title, text)</span> </span>{
  <span class="hljs-keyword">var</span> localHref = (isLocalLink(href) ? localLink(href) : href);
  <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;a href="'</span> +
          localHref +
          (title ? (<span class="hljs-string">'" title="'</span> + escapeHTML(title)) : <span class="hljs-string">''</span>) +
          <span class="hljs-string">'"&gt;'</span> +
          text +
          <span class="hljs-string">'&lt;/a&gt;'</span>;
};




</code></pre></div></div><div class="row"><div class="documentation"><h2 id="renderer-heading">renderer.heading<a class="anchor" href="#renderer-heading"></a></h2><p> Adds a link to reference the heading. The link added is empty but can be styled with CSS.</p>
</div><div class="code"><pre><code class="js">renderer.heading = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(text, level)</span> </span>{
  <span class="hljs-keyword">var</span> escapedText = text.toLowerCase().replace(<span class="hljs-regexp">/[^\w]+/g</span>, <span class="hljs-string">'-'</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;h'</span> + level + <span class="hljs-string">' id="'</span> +
          escapedText +
          <span class="hljs-string">'"&gt;'</span> +
          text +
          <span class="hljs-string">'&lt;a class="anchor" href="#'</span> +
          escapedText +
          <span class="hljs-string">'"&gt;&lt;/a&gt;'</span> +
          <span class="hljs-string">'&lt;/h'</span> + level + <span class="hljs-string">'&gt;'</span>;
};


</code></pre></div></div><div class="row"><div class="documentation"><h3 id="configurations">configurations<a class="anchor" href="#configurations"></a></h3><h4 id="highlight-js-options">highlight.js options<a class="anchor" href="#highlight-js-options"></a></h4></div><div class="code"><pre><code class="js">hljs.configure({
  tabReplace: <span class="hljs-string">'  '</span>
});
</code></pre></div></div><div class="row"><div class="documentation"><h4 id="marked-options">marked options<a class="anchor" href="#marked-options"></a></h4><p> It uses the line breaks parsing of <a href="//help.github.com/articles/writing-on-github/#newlines">GitHub</a>, has <code>highlight.js</code> and the <code>renderer</code>.</p>
</div><div class="code"><pre><code class="js">marked.setOptions({
  breaks: <span class="hljs-literal">true</span>,
  smartypants: <span class="hljs-literal">true</span>,
  highlight: highlight,
  renderer: renderer
});


</code></pre></div></div><div class="row"><div class="documentation"><h2 id="breadcrumb">breadcrumb<a class="anchor" href="#breadcrumb"></a></h2><p> Renders a <em>breadcrumb</em> for the model.</p>
</div><div class="code"><pre><code class="js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">breadcrumb</span><span class="hljs-params">(model)</span> </span>{
  <span class="hljs-keyword">var</span> pieces = [];
  <span class="hljs-keyword">var</span> used = [];
  <span class="hljs-keyword">var</span> parts = model.dirname.split(<span class="hljs-string">'/'</span>);
  <span class="hljs-keyword">var</span> part;
  <span class="hljs-keyword">while</span> (parts.length) {
    part = parts.shift();
    <span class="hljs-keyword">var</span> partPath = repeatStr(parts.length - <span class="hljs-number">1</span>).join(<span class="hljs-string">'/'</span>);
    used.push(part);
    <span class="hljs-keyword">if</span> (model.collection.get(used.join(<span class="hljs-string">'/'</span>) + <span class="hljs-string">'/index.html'</span>)) {
      pieces.push(<span class="hljs-string">'&lt;li&gt;&lt;a href="'</span> + partPath + <span class="hljs-string">'/index.html"&gt;'</span> + part + <span class="hljs-string">'&lt;/a&gt;&lt;/li&gt;'</span>);
    }
    <span class="hljs-keyword">else</span> {
      pieces.push(<span class="hljs-string">'&lt;li&gt;'</span> + part + <span class="hljs-string">'&lt;/li&gt;'</span>);
    }
  }
  <span class="hljs-keyword">return</span>  <span class="hljs-string">'&lt;ul class="breadcrumb"&gt;'</span> + pieces.join(<span class="hljs-string">''</span>) + <span class="hljs-string">'&lt;/ul&gt;'</span>;
}

</code></pre></div></div><div class="row"><div class="documentation"><h2 id="navigation">navigation<a class="anchor" href="#navigation"></a></h2><p> Renders the navigation tree for a file model.<br> Have a look at the templates:</p>
<ul>
<li><a href="../resources/themes/default/navigation.jst.html">navigation.jst</a></li>
<li><a href="../resources/themes/default/navigation-item.jst.html">navigation-item.jst</a></li>
</ul>
</div><div class="code"><pre><code class="js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">navigation</span><span class="hljs-params">(model)</span> </span>{
  <span class="hljs-keyword">var</span> navigationItem = _.template(itemTemplate);

  <span class="hljs-keyword">return</span> _.template(navigationTemplate)({
    navigationItem: navigationItem,
    collection: model.collection
  });
}
</code></pre></div></div><div class="row"><div class="documentation"><h2 id="extractmdtitle">extractMDTitle<a class="anchor" href="#extractmdtitle"></a></h2><p> Can be used to extract the first level 1 (h1) of a text.<br> By setting wantText argument to true, the returned string is the text without the first h1.</p>
</div><div class="code"><pre><code class="js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">extractMDTitle</span><span class="hljs-params">(str, wantText)</span> </span>{
  <span class="hljs-keyword">var</span> title = <span class="hljs-string">''</span>;

  <span class="hljs-keyword">var</span> originalHeading = renderer.heading;

  renderer.heading = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(text, level)</span> </span>{
    <span class="hljs-keyword">if</span> (!title &amp;&amp; (level === <span class="hljs-string">'1'</span> || level === <span class="hljs-number">1</span>)) {
      title = text;
      <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
    }
    <span class="hljs-keyword">return</span> originalHeading(text, level);
  };

  <span class="hljs-keyword">var</span> withoutTitle = marked(str);

  renderer.heading = originalHeading;

  <span class="hljs-keyword">return</span> wantText ? withoutTitle : title;
}

</code></pre></div></div><div class="row"><div class="documentation"><h2 id="settheme">setTheme<a class="anchor" href="#settheme"></a></h2><p> Provides a function to change the theme path and reload the templates accordingly.</p>
</div><div class="code"><pre><code class="js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setTheme</span><span class="hljs-params">(newThemePath)</span> </span>{
  themePath           = newThemePath;
  navigationTemplate  = read(join(themePath, <span class="hljs-string">'navigation.jst'</span>));
  itemTemplate        = read(join(themePath, <span class="hljs-string">'navigation-item.jst'</span>));
}

</code></pre></div></div><div class="row"><div class="documentation"><h3 id="exports">exports<a class="anchor" href="#exports"></a></h3><ul>
<li><a href="#navigation"><code>navigation</code></a></li>
<li><a href="#breadcrumb"><code>breadcrumb</code></a></li>
<li><a href="#marked"><code>marked</code></a></li>
<li><a href="#renderer"><code>renderer</code></a></li>
<li><a href="#highlight"><code>highlight</code></a></li>
<li><a href="#extractmdtitle"><code>extractMDTitle</code></a></li>
<li><a href="#settheme"><code>setTheme</code></a></li>
</ul>
</div><div class="code"><pre><code class="js"><span class="hljs-built_in">module</span>.exports = {
  navigation:     navigation,
  breadcrumb:     breadcrumb,
  marked:         marked,
  renderer:       renderer,
  highlight:      highlight,
  extractMDTitle: extractMDTitle,
  setTheme:       setTheme
};
</code></pre></div></div>
  </div>


  <script src="../assets/scripts/scripts.js"></script>
  <script>
  var config = {"files":["Gruntfile.js","README.md","lib/blocks-collection.js","lib/index.js","lib/rendering-utils.js","node_modules/ampersand-collection/README.md","node_modules/ampersand-collection/ampersand-collection.js","node_modules/ampersand-model/README.md","node_modules/ampersand-model/ampersand-model.js","node_modules/faceted-search/README.md","node_modules/faceted-search/index.js","node_modules/faceted-search/results.js","node_modules/faceted-search/styles.css","node_modules/files-collection/DOCUMENTATION.md","node_modules/files-collection/README.md","node_modules/files-collection/index.js","node_modules/files-collection/node.js","resources/test/README.md","resources/test/dir/README.md","resources/test/dir/sub/README.md","resources/themes/README.md","resources/themes/default/README.md","resources/themes/default/assets/scripts/scripts.src.js","resources/themes/default/assets/styles/styles.css","resources/themes/default/file.jst","resources/themes/default/navigation-item.jst","resources/themes/default/navigation.jst","tasks/gtfd.js"],"active":"lib/rendering-utils.js"};
  config.files = (config.files || []).map(function (filepath) {
    return { filepath: filepath };
  });
  config.el = document.body;
  new gtfd(config);
  </script>
</body>
</html>
