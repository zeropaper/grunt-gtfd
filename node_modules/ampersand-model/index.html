<html>

<head>
  <title>ampersand-model</title>
  <link type="text/css" rel="stylesheet" href="../../assets/styles/styles.css" />
</head>

<body>
  <header>
    <div class="row">
      
        <ul class="breadcrumb"><li>node_modules</li></ul>
      
    </div>
    <h1>ampersand-model</h1>
  </header>

  <nav class="docs-nav">
  <div class="search"></div>

  <div class="toggle">Files</div>

  <ul class="directory root">
  
    <li class="index">
      <a href="../../index.html">Home</a>
    </li>
  

  
    <li class="">
      
  <a href="../../Gruntfile.js.html">Gruntfile.js</a>


    </li>
  
    <li class="">
      
  
  
    <span class="dirname">lib</span>
  

  <ul class="directory">
  

    <li class="">
      
  <a href="../../lib/blocks-collection.js.html">blocks-collection.js</a>


    </li>

    

    <li class="">
      
  <a href="../../lib/index.js.html">index.js</a>


    </li>

    

    <li class="">
      
  <a href="../../lib/rendering-utils.js.html">rendering-utils.js</a>


    </li>

    
  </ul>


    </li>
  
    <li class="trail">
      
  
  
    <span class="dirname">node_modules</span>
  

  <ul class="directory">
  

    <li class="">
      
  
  
    <a class="index" href="../ampersand-collection/index.html">ampersand-collection</a>
  

  <ul class="directory">
  

    <li class="">
      
  <a href="../ampersand-collection/ampersand-collection.js.html">ampersand-collection.js</a>


    </li>

    
  </ul>


    </li>

    

    <li class="active">
      
  
  
    <a class="index" href="index.html">ampersand-model</a>
  

  <ul class="directory">
  

    <li class="">
      
  <a href="ampersand-model.js.html">ampersand-model.js</a>


    </li>

    
  </ul>


    </li>

    

    <li class="">
      
  
  
    <a class="index" href="../faceted-search/index.html">faceted-search</a>
  

  <ul class="directory">
  

    <li class="">
      
  <a href="../faceted-search/index.js.html">index.js</a>


    </li>

    

    <li class="">
      
  <a href="../faceted-search/results.js.html">results.js</a>


    </li>

    

    <li class="">
      
  <a href="../faceted-search/styles.css.html">styles.css</a>


    </li>

    
  </ul>


    </li>

    

    <li class="">
      
  
  
    <a class="index" href="../files-collection/index.html">files-collection</a>
  

  <ul class="directory">
  

    <li class="">
      
  <a href="../files-collection/DOCUMENTATION.md.html">DOCUMENTATION.md</a>


    </li>

    

    <li class="">
      
  <a href="../files-collection/index.js.html">index.js</a>


    </li>

    

    <li class="">
      
  <a href="../files-collection/node.js.html">node.js</a>


    </li>

    
  </ul>


    </li>

    
  </ul>


    </li>
  
    <li class="">
      
  
  
    <span class="dirname">resources</span>
  

  <ul class="directory">
  

    <li class="">
      
  
  
    <a class="index" href="../../resources/test/index.html">test</a>
  

  <ul class="directory">
  

    <li class="">
      
  
  
    <a class="index" href="../../resources/test/dir/index.html">dir</a>
  

  <ul class="directory">
  

    <li class="">
      
  
  
    <a class="index" href="../../resources/test/dir/sub/index.html">sub</a>
  

  <ul class="directory">
  
  </ul>


    </li>

    
  </ul>


    </li>

    
  </ul>


    </li>

    

    <li class="">
      
  
  
    <a class="index" href="../../resources/themes/index.html">themes</a>
  

  <ul class="directory">
  

    <li class="">
      
  
  
    <a class="index" href="../../resources/themes/default/index.html">default</a>
  

  <ul class="directory">
  

    <li class="">
      
  <a href="../../resources/themes/default/file.jst.html">file.jst</a>


    </li>

    

    <li class="">
      
  <a href="../../resources/themes/default/navigation-item.jst.html">navigation-item.jst</a>


    </li>

    

    <li class="">
      
  <a href="../../resources/themes/default/navigation.jst.html">navigation.jst</a>


    </li>

    

    <li class="">
      
  
  
    <span class="dirname">assets</span>
  

  <ul class="directory">
  

    <li class="">
      
  
  
    <span class="dirname">scripts</span>
  

  <ul class="directory">
  

    <li class="">
      
  <a href="../../resources/themes/default/assets/scripts/scripts.src.js.html">scripts.src.js</a>


    </li>

    
  </ul>


    </li>

    

    <li class="">
      
  
  
    <span class="dirname">styles</span>
  

  <ul class="directory">
  

    <li class="">
      
  <a href="../../resources/themes/default/assets/styles/styles.css.html">styles.css</a>


    </li>

    
  </ul>


    </li>

    
  </ul>


    </li>

    
  </ul>


    </li>

    
  </ul>


    </li>

    
  </ul>


    </li>
  
    <li class="">
      
  
  
    <span class="dirname">tasks</span>
  

  <ul class="directory">
  

    <li class="">
      
  <a href="../../tasks/gtfd.js.html">gtfd.js</a>


    </li>

    
  </ul>


    </li>
  
  </ul>
</nav>



  <div class="container content">
    <!-- index --><!-- starthide --><br>Part of the <a href="http://ampersandjs.com">Ampersand.js toolkit</a> for building clientside applications.<br><!-- endhide -->

<p>ampersand-model is an extension built on <a href="http://ampersandjs.com/docs/#ampersand-state">ampersand-state</a> to provide methods and properties that you’ll often want when modeling data you get from an API.</p>
<p>For further explanation see the <a href="http://ampersandjs.com/learn/state">learn ampersand-state</a> guide.</p>
<h2 id="installing">Installing<a class="anchor" href="#installing"></a></h2><pre><code><pre><code class="undefined">npm install ampersand-model</code></pre>
</code></pre><h2 id="observing">Observing<a class="anchor" href="#observing"></a></h2><p>Ampersand gets its event system from Backbone using the <a href="https://www.npmjs.org/package/backbone-events-standalone">backbone-events-standalone</a> module on npm.</p>
<p>For more, <a href="http://ampersandjs.com/learn/events">read all about how events work in ampersand</a>.</p>
<h2 id="browser-compatibility">Browser compatibility<a class="anchor" href="#browser-compatibility"></a></h2><p><a href="https://ci.testling.com/ampersandjs/ampersand-model"><img src="https://ci.testling.com/ampersandjs/ampersand-model.png" alt="testling badge"></a></p>
<h2 id="api-reference">API Reference<a class="anchor" href="#api-reference"></a></h2><p>The module exports just one item, the ampersand-model constructor. It’s has a method called <code>extend</code> that works as follows:</p>
<h3 id="extend-code-ampersandmodel-extend-code-">extend <code>AmpersandModel.extend({ })</code><a class="anchor" href="#extend-code-ampersandmodel-extend-code-"></a></h3><p>To create a <strong>Model</strong> class of your own, you extend <strong>AmpersandModel</strong> and provide instance properties and options for your class. Typically here you will pass any properties (<code>props</code>, <code>session</code>, and <code>derived</code>) of your model class, and any instance methods to be attached to instances of your class.</p>
<p><strong>extend</strong> correctly sets up the prototype chain, so that subclasses created with <strong>extend</strong> can be further extended as many times as you like.</p>
<p>As with AmpersandState, definitions like <code>props</code>, <code>session</code>, <code>derived</code> etc will be merged with superclass definitions.</p>
<pre><code class="lang-javascript"><pre><code class="javascript"><span class="hljs-keyword">var</span> Person = AmpersandModel.extend({
    props: {
        firstName: <span class="hljs-string">'string'</span>,
        lastName: <span class="hljs-string">'string'</span>
    },
    session: {
        signedIn: [<span class="hljs-string">'boolean'</span>, <span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>],
    },
    derived: {
        fullName: {
            deps: [<span class="hljs-string">'firstName'</span>, <span class="hljs-string">'lastName'</span>],
            fn: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.firstName + <span class="hljs-string">' '</span> + <span class="hljs-keyword">this</span>.lastName;
            }
        }
    }
});</code></pre>
</code></pre>
<h3 id="constructor-initialize-code-new-extendedampersandmodel-attrs-options-code-">constructor/initialize <code>new ExtendedAmpersandModel([attrs], [options])</code><a class="anchor" href="#constructor-initialize-code-new-extendedampersandmodel-attrs-options-code-"></a></h3><p>This works exactly like <a href="http://ampersandjs.com/docs/#ampersand-state-constructorinitialize">state</a> with a minor addition: If you pass <code>collection</code> as part of options it’ll be stored for reference.</p>
<p>As with AmpersandState, if you have defined an <strong>initialize</strong> function for your subclass of State, it will be invoked at creation time.</p>
<pre><code class="lang-javascript"><pre><code class="javascript"><span class="hljs-keyword">var</span> me = <span class="hljs-keyword">new</span> Person({
    firstName: <span class="hljs-string">'Phil'</span>,
    lastName: <span class="hljs-string">'Roberts'</span>
});

me.firstName <span class="hljs-comment">//=&gt; Phil</span></code></pre>
</code></pre>
<p>Available options:</p>
<ul>
<li><code>[parse]</code> {Boolean} - whether to call the class’s <a href="#ampersand-state-parse">parse</a> function with the initial attributes. <em>Defaults to <code>false</code></em>.</li>
<li><code>[parent]</code> {AmpersandState} - pass a reference to a model’s parent to store on the model.</li>
<li><code>[collection]</code> {Collection} - pass a reference to the collection the model is in. Defaults to <code>undefined</code>.</li>
</ul>
<h3 id="save-code-model-save-attributes-options-code-">save <code>model.save([attributes], [options])</code><a class="anchor" href="#save-code-model-save-attributes-options-code-"></a></h3><p>Save a model to your database (or alternative persistence layer), by delegating to <a href="https://github.com/ampersandjs/ampersand-sync">ampersand-sync</a>. Returns a xhr object if validation is successful and false otherwise. The attributes hash (as in set) should contain the attributes you’d like to change — keys that aren’t mentioned won’t be altered — but, a <em>complete representation</em> of the resource will be sent to the server. As with <code>set</code>, you may pass individual keys and values instead of a hash. If the model has a validate method, and validation fails, the model will not be saved. If the model <code>isNew</code>, the save will be a “create” (HTTP POST), if the model already exists on the server, the save will be an “update” (HTTP PUT).</p>
<p>If instead, you’d only like the changed attributes to be sent to the server, call <code>model.save(attrs, {patch: true})</code>. You’ll get an HTTP PATCH request to the server with just the passed-in attributes.</p>
<p>Calling save with new attributes will cause a <code>&quot;change&quot;</code> event immediately, a <code>&quot;request&quot;</code> event as the Ajax request begins to go to the server, and a <code>&quot;sync&quot;</code> event after the server has acknowledged the successful change. Pass <code>{wait: true}</code> if you’d like to wait for the server before setting the new attributes on the model.</p>
<pre><code class="lang-javascript"><pre><code class="javascript"><span class="hljs-keyword">var</span> book = <span class="hljs-keyword">new</span> Backbone.Model({
  title: <span class="hljs-string">"The Rough Riders"</span>,
  author: <span class="hljs-string">"Theodore Roosevelt"</span>
});

book.save();
<span class="hljs-comment">//=&gt; triggers a `POST` via ampersand-sync with { "title": "The Rough Riders", "author": "Theodore Roosevelt" }</span>

book.save({author: <span class="hljs-string">"Teddy"</span>});
<span class="hljs-comment">//=&gt; triggers a `PUT` via ampersand-sync with { "title": "The Rough Riders", "author": "Teddy" }</span></code></pre>
</code></pre>
<p><strong>save</strong> accepts <code>success</code> and <code>error</code> callbacks in the options hash, which will be passed the arguments <code>(model, response, options)</code>. If a server-side validation fails, return a non-<code>200</code> HTTP response code, along with an error response in text or JSON.</p>
<h3 id="fetch-code-model-fetch-options-code-">fetch <code>model.fetch([options])</code><a class="anchor" href="#fetch-code-model-fetch-options-code-"></a></h3><p>Resets the model’s state from the server by delegating to ampersand-sync. Returns a xhr. Useful if the model has yet to be populated with data, or you want to ensure you have the latest server state. A <code>&quot;change&quot;</code> event will be triggered if the retrieved state from the server differs from the current attributes. Accepts <code>success</code> and <code>error</code> callbacks in the options hash, which are both passed <code>(model, response, options)</code> as arguments.</p>
<pre><code class="lang-javascript"><pre><code class="javascript"><span class="hljs-keyword">var</span> me = <span class="hljs-keyword">new</span> Person({id: <span class="hljs-number">123</span>});
me.fetch();</code></pre>
</code></pre>
<h3 id="destroy-code-model-destroy-options-code-">destroy <code>model.destroy([options])</code><a class="anchor" href="#destroy-code-model-destroy-options-code-"></a></h3><p>Destroys the model on the server by delegating an HTTP <code>DELETE</code> request to ampersand-sync. Returns the xhr object, or <code>false</code> if the model <a href="#ampersand-model-isnew">isNew</a>. Accepts <code>success</code> and <code>error</code> callbacks in the options hash, which are both passed <code>(model, response, options)</code> as arguments.</p>
<p>Triggers:</p>
<ul>
<li>a <code>&quot;destroy&quot;</code> event on the model, which will bubble up through any collections which contain it.</li>
<li>a <code>&quot;request&quot;</code> event as it begins the Ajax request to the server</li>
<li>a <code>&quot;sync&quot;</code> event, after the server has successfully acknowledged the model’s deletion.</li>
</ul>
<p>Pass <code>{wait: true}</code> if you’d like to wait for the server to respond before removing the model from the collection.</p>
<pre><code class="lang-javascript"><pre><code class="javascript"><span class="hljs-keyword">var</span> task = <span class="hljs-keyword">new</span> Task({id: <span class="hljs-number">123</span>});
task.destroy({
    success: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        alert(<span class="hljs-string">'Task destroyed!'</span>);
    },
    error: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        alert(<span class="hljs-string">'There was an error destroying the task'</span>);
    },
});</code></pre>
</code></pre>
<h3 id="sync-code-model-sync-method-model-options-code-">sync <code>model.sync(method, model, [options])</code><a class="anchor" href="#sync-code-model-sync-method-model-options-code-"></a></h3><p>Uses ampersand-sync to persist the state of a model to the server. Usually you won’t call this directly, you’d use <code>save</code> or <code>destroy</code> instead, but it can be overriden for custom behaviour.</p>
<h3 id="ajaxconfig-code-model-ajaxconfig-or-model-ajaxconfig-code-">ajaxConfig <code>model.ajaxConfig or model.ajaxConfig()</code><a class="anchor" href="#ajaxconfig-code-model-ajaxconfig-or-model-ajaxconfig-code-"></a></h3><p>ampersand-sync will call ajaxConfig on your model before it makes the request to the server, and will merge in any options you return to the request. When extending your own model, set an ajaxConfig function to modify the request before it goes to the server.</p>
<p>ajaxConfig can either be an object, or a function that returns an object, with the following options:</p>
<ul>
<li><code>useXDR</code> [boolean]: (applies to IE8/9 only with cross domain requests): signifies that this is a cross-domain request and that IE should use it’s XDomainRequest object. This is required if you’re making cross-domain requests and want to support IE8/9). Note that XDR doesn’t support headers/withCredentials.</li>
<li><code>headers</code> [object]: any extra headers to send with the request.</li>
<li><code>xhrFields</code> [object]: any fields to set directly on the <a href="https://developer.mozilla.org/en/docs/Web/API/XMLHttpRequest">XHR</a> request object, most typically:<ul>
<li><code>withCredentials</code> [boolean]: whether to send cross domain requests with authorization headers/cookies. Useful if you’re making cross sub-domain requests with a root-domain auth cookie.</li>
</ul>
</li>
<li><code>beforeSend</code> [function]: beforeSend will be called before the request is made, and will be passed the raw <code>xhr</code> object if you wish to modify it directly before it’s sent.</li>
</ul>
<pre><code class="lang-javascript"><pre><code class="javascript"><span class="hljs-keyword">var</span> Person = AmpersandModel.extend({
    urlRoot: <span class="hljs-string">'http://otherdomain.example.com/people'</span>,

    ajaxConfig: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> {
            headers: {
                <span class="hljs-string">'Access-Token'</span>: <span class="hljs-keyword">this</span>.accessToken
            },
            xhrFields: {
                <span class="hljs-string">'withCredentials'</span>: <span class="hljs-literal">true</span>
            }
        };
    }
});

<span class="hljs-keyword">var</span> me = <span class="hljs-keyword">new</span> Person({ id: <span class="hljs-number">123</span> });
me.fetch();</code></pre>
</code></pre>
<h1 id="configuring">Configuring<a class="anchor" href="#configuring"></a></h1><h3 id="url-code-model-url-or-model-url-code-">url <code>model.url or model.url()</code><a class="anchor" href="#url-code-model-url-or-model-url-code-"></a></h3><p>The relative url the model should use to edit the resource on the server. </p>
<h3 id="urlroot-code-model-urlroot-or-model-urlroot-code-">urlRoot <code>model.urlRoot or model.urlRoot()</code><a class="anchor" href="#urlroot-code-model-urlroot-or-model-urlroot-code-"></a></h3><p>The base url to use for fetching this model. This is useful if the model is <em>not</em> in a collection and you still want to set a fixed “root” but have a dynamic model.url(). Can also be a function.</p>
<p>If your model is in a collection that has a <code>url</code> you won’t need this, because the model will try to build the URL from its collection.</p>
<pre><code class="lang-js"><pre><code class="js"><span class="hljs-keyword">var</span> Person = AmpersandModel.extend({
    props: {
        id: <span class="hljs-string">'string'</span>,
        name: <span class="hljs-string">'string'</span>
    },
    urlRoot: <span class="hljs-string">'/api/persons'</span>
});

<span class="hljs-keyword">var</span> bob = <span class="hljs-keyword">new</span> Person({id: <span class="hljs-string">"1234"</span>});

<span class="hljs-built_in">console</span>.log(bob.url()); <span class="hljs-comment">//=&gt; "/api/persons/1234"</span></code></pre>
</code></pre>
<h2 id="license">License<a class="anchor" href="#license"></a></h2><p>MIT</p>

  </div>


  <script src="../../assets/scripts/scripts.js"></script>
  <script>
  var config = {"files":["Gruntfile.js","README.md","lib/blocks-collection.js","lib/index.js","lib/rendering-utils.js","node_modules/ampersand-collection/README.md","node_modules/ampersand-collection/ampersand-collection.js","node_modules/ampersand-model/README.md","node_modules/ampersand-model/ampersand-model.js","node_modules/faceted-search/README.md","node_modules/faceted-search/index.js","node_modules/faceted-search/results.js","node_modules/faceted-search/styles.css","node_modules/files-collection/DOCUMENTATION.md","node_modules/files-collection/README.md","node_modules/files-collection/index.js","node_modules/files-collection/node.js","resources/test/README.md","resources/test/dir/README.md","resources/test/dir/sub/README.md","resources/themes/README.md","resources/themes/default/README.md","resources/themes/default/assets/scripts/scripts.src.js","resources/themes/default/assets/styles/styles.css","resources/themes/default/file.jst","resources/themes/default/navigation-item.jst","resources/themes/default/navigation.jst","tasks/gtfd.js"],"active":"node_modules/ampersand-model"};
  config.files = (config.files || []).map(function (filepath) {
    return { filepath: filepath };
  });
  config.el = document.body;
  new gtfd(config);
  </script>
</body>
</html>
