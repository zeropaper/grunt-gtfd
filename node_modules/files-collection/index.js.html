<html>

<head>
  <title>FilesCollection</title>
  <link type="text/css" rel="stylesheet" href="../../assets/styles/styles.css" />
</head>

<body>
  <header>
    <div class="row">
      
        <ul class="breadcrumb"><li>node_modules</li><li>files-collection</li></ul>
      
    </div>
    <h1>FilesCollection</h1>
  </header>

  <nav class="docs-nav">
  <div class="search"></div>

  <div class="toggle">Files</div>

  <ul class="directory root">
  
    <li class="index">
      <a href="../../index.html">Home</a>
    </li>
  

  
    <li class="">
      
  <a href="../../Gruntfile.js.html">Gruntfile.js</a>


    </li>
  
    <li class="">
      
  
  
    <span class="dirname">lib</span>
  

  <ul class="directory">
  

    <li class="">
      
  <a href="../../lib/blocks-collection.js.html">blocks-collection.js</a>


    </li>

    

    <li class="">
      
  <a href="../../lib/index.js.html">index.js</a>


    </li>

    

    <li class="">
      
  <a href="../../lib/rendering-utils.js.html">rendering-utils.js</a>


    </li>

    
  </ul>


    </li>
  
    <li class="trail">
      
  
  
    <span class="dirname">node_modules</span>
  

  <ul class="directory">
  

    <li class="">
      
  
  
    <a class="index" href="../ampersand-collection/index.html">ampersand-collection</a>
  

  <ul class="directory">
  

    <li class="">
      
  <a href="../ampersand-collection/ampersand-collection.js.html">ampersand-collection.js</a>


    </li>

    
  </ul>


    </li>

    

    <li class="">
      
  
  
    <a class="index" href="../ampersand-model/index.html">ampersand-model</a>
  

  <ul class="directory">
  

    <li class="">
      
  <a href="../ampersand-model/ampersand-model.js.html">ampersand-model.js</a>


    </li>

    
  </ul>


    </li>

    

    <li class="">
      
  
  
    <a class="index" href="../faceted-search/index.html">faceted-search</a>
  

  <ul class="directory">
  

    <li class="">
      
  <a href="../faceted-search/index.js.html">index.js</a>


    </li>

    

    <li class="">
      
  <a href="../faceted-search/results.js.html">results.js</a>


    </li>

    

    <li class="">
      
  <a href="../faceted-search/styles.css.html">styles.css</a>


    </li>

    
  </ul>


    </li>

    

    <li class="trail">
      
  
  
    <a class="index" href="index.html">files-collection</a>
  

  <ul class="directory">
  

    <li class="">
      
  <a href="DOCUMENTATION.md.html">DOCUMENTATION.md</a>


    </li>

    

    <li class="active">
      
  <a href="index.js.html">index.js</a>


    </li>

    

    <li class="">
      
  <a href="node.js.html">node.js</a>


    </li>

    
  </ul>


    </li>

    
  </ul>


    </li>
  
    <li class="">
      
  
  
    <span class="dirname">resources</span>
  

  <ul class="directory">
  

    <li class="">
      
  
  
    <a class="index" href="../../resources/test/index.html">test</a>
  

  <ul class="directory">
  

    <li class="">
      
  
  
    <a class="index" href="../../resources/test/dir/index.html">dir</a>
  

  <ul class="directory">
  

    <li class="">
      
  
  
    <a class="index" href="../../resources/test/dir/sub/index.html">sub</a>
  

  <ul class="directory">
  
  </ul>


    </li>

    
  </ul>


    </li>

    
  </ul>


    </li>

    

    <li class="">
      
  
  
    <a class="index" href="../../resources/themes/index.html">themes</a>
  

  <ul class="directory">
  

    <li class="">
      
  
  
    <a class="index" href="../../resources/themes/default/index.html">default</a>
  

  <ul class="directory">
  

    <li class="">
      
  <a href="../../resources/themes/default/file.jst.html">file.jst</a>


    </li>

    

    <li class="">
      
  <a href="../../resources/themes/default/navigation-item.jst.html">navigation-item.jst</a>


    </li>

    

    <li class="">
      
  <a href="../../resources/themes/default/navigation.jst.html">navigation.jst</a>


    </li>

    

    <li class="">
      
  
  
    <span class="dirname">assets</span>
  

  <ul class="directory">
  

    <li class="">
      
  
  
    <span class="dirname">scripts</span>
  

  <ul class="directory">
  

    <li class="">
      
  <a href="../../resources/themes/default/assets/scripts/scripts.src.js.html">scripts.src.js</a>


    </li>

    
  </ul>


    </li>

    

    <li class="">
      
  
  
    <span class="dirname">styles</span>
  

  <ul class="directory">
  

    <li class="">
      
  <a href="../../resources/themes/default/assets/styles/styles.css.html">styles.css</a>


    </li>

    
  </ul>


    </li>

    
  </ul>


    </li>

    
  </ul>


    </li>

    
  </ul>


    </li>

    
  </ul>


    </li>
  
    <li class="">
      
  
  
    <span class="dirname">tasks</span>
  

  <ul class="directory">
  

    <li class="">
      
  <a href="../../tasks/gtfd.js.html">gtfd.js</a>


    </li>

    
  </ul>


    </li>
  
  </ul>
</nav>



  <div class="container content">
    <div class="row"><div class="documentation"><p> @module FilesCollection<br> @environment browser, node<br> _name FilesCollection<br> @extends AmpersandCollection</p>
<p> A CommonJS module based on Ampersand.js aimed to manage virtual files.</p>
</div><div class="code"><pre><code class="js"><span class="hljs-pi">'use strict'</span>;
<span class="hljs-comment">/* jshint node: true, browser: true */</span>
<span class="hljs-comment">/* global require: false */</span>
<span class="hljs-keyword">var</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);

<span class="hljs-keyword">var</span> Collection = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ampersand-collection'</span>);
<span class="hljs-keyword">var</span> Model = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ampersand-model'</span>);






</code></pre></div></div><div class="row"><div class="documentation"><p> @function extname<br> @private<br> @param {String} str  - is a path string<br> @returns {String}    - the base name of <code>str</code> <strong>always</strong> without <code>.html</code> extension</p>
</div><div class="code"><pre><code class="js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">extname</span><span class="hljs-params">(str)</span> </span>{
  <span class="hljs-keyword">return</span> path.extname(path.basename(str, <span class="hljs-string">'.html'</span>));
}
</code></pre></div></div><div class="row"><div class="documentation"><p> @function toProject<br> @private<br> @param {String} str  - is the path below the the root of the project<br> @returns {String}    - the relative path to the project root<br>                        (generally something like: ‘../../..’)</p>
</div><div class="code"><pre><code class="js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toProject</span><span class="hljs-params">(str)</span> </span>{
  <span class="hljs-keyword">return</span> str.split(<span class="hljs-string">'/'</span>).length &gt; <span class="hljs-number">1</span> ?
          path.dirname(str).replace(<span class="hljs-regexp">/([^\/]+)/gi</span>, <span class="hljs-string">'..'</span>) :
          <span class="hljs-string">''</span>;
}
</code></pre></div></div><div class="row"><div class="documentation"><p> @function index<br> @private<br> @param {Object} [options] - a set of options<br> @returns {AmpersandMode|AmpersandState|false}</p>
</div><div class="code"><pre><code class="js">
</code></pre></div></div><div class="row"><div class="documentation"><p> @typedef<br> @name FileModel<br> @extends AmpersandModel</p>
</div><div class="code"><pre><code class="js"><span class="hljs-keyword">var</span> FileModel;
</code></pre></div></div><div class="row"><div class="documentation"><p> @typedef DirectoryCollection<br> @extends AmpersandCollection</p>
</div><div class="code"><pre><code class="js"><span class="hljs-keyword">var</span> DirectoryCollection = Collection.extend({
  mainIndex: <span class="hljs-string">'filepath'</span>,
  idAttribute: <span class="hljs-string">'filepath'</span>,

  indexes: [
    <span class="hljs-string">'basename'</span>
  ],

  comparator: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(a, b)</span> </span>{
    <span class="hljs-keyword">if</span> (a.isDir !== b.isDir) {
      <span class="hljs-keyword">if</span> (a.isDir) { <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; }
      <span class="hljs-keyword">if</span> (b.isDir) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
    }
    <span class="hljs-keyword">return</span> a.basename &gt; b.basename;
  },

  model: FileModel
});



FileModel = Model.extend({
  idAttribute: <span class="hljs-string">'filepath'</span>,

  props: {
    filepath: [<span class="hljs-string">'string'</span>, <span class="hljs-literal">true</span>]
  },

  collections: {
    files: DirectoryCollection
  },

  derived: {
    isFile: {
      cache: <span class="hljs-literal">false</span>,
      fn: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.files.length &lt; <span class="hljs-number">1</span>;
      }
    },

    isDir: {
      cache: <span class="hljs-literal">false</span>,
      fn: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.files.length &gt; <span class="hljs-number">0</span>;
      }
    },

    isIndex: {
      deps: [<span class="hljs-string">'filepath'</span>],
      cache: <span class="hljs-literal">false</span>,
      fn: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">var</span> index = <span class="hljs-keyword">this</span>.directory.index();
        <span class="hljs-keyword">return</span> index ? index.filepath === <span class="hljs-keyword">this</span>.filepath : <span class="hljs-literal">false</span>;
      }
    },

    directory: {
      deps: [<span class="hljs-string">'filepath'</span>, <span class="hljs-string">'collection'</span>],
      cache: <span class="hljs-literal">false</span>,
      fn: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.collection.get(<span class="hljs-keyword">this</span>.dirname);
      }
    },

    isRootDir: {
      deps: [<span class="hljs-string">'filepath'</span>],
      fn: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> [
          <span class="hljs-string">''</span>,
          <span class="hljs-string">'.'</span>,
          <span class="hljs-string">'./'</span>
        ].indexOf(<span class="hljs-keyword">this</span>.filepath) &gt; -<span class="hljs-number">1</span>;
      }
    },

    trail: {
      cache: <span class="hljs-literal">false</span>,
      fn: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.isDir &amp;&amp;
          <span class="hljs-keyword">this</span>.collection.active.indexOf(<span class="hljs-keyword">this</span>.filepath) === <span class="hljs-number">0</span>;
      }
    },

    dirname: {
      deps: [<span class="hljs-string">'filepath'</span>],
      fn: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> path.dirname(<span class="hljs-keyword">this</span>.filepath);
      }
    },

    toProjectDir: {
      deps: [<span class="hljs-string">'filepath'</span>],
      fn: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> toProject(<span class="hljs-keyword">this</span>.isIndex ? path.join(<span class="hljs-keyword">this</span>.filepath, <span class="hljs-string">'index'</span>) : <span class="hljs-keyword">this</span>.filepath);
      }
    },

    basename: {
      deps: [<span class="hljs-string">'filepath'</span>],
      fn: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> path.basename(<span class="hljs-keyword">this</span>.filepath, <span class="hljs-string">'.html'</span>);
      }
    },

    extname: {
      deps: [<span class="hljs-string">'filepath'</span>],
      fn: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> extname(<span class="hljs-keyword">this</span>.filepath);
      }
    },

    fileurl: {
      deps: [<span class="hljs-string">'filepath'</span>],
      cache: <span class="hljs-literal">false</span>,
      fn: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">var</span> to = <span class="hljs-keyword">this</span>.filepath;
        <span class="hljs-keyword">var</span> active = <span class="hljs-keyword">this</span>.collection.getActive();

        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isIndex) {
          to = path.join(<span class="hljs-keyword">this</span>.dirname, <span class="hljs-string">'index'</span>);
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isDir &amp;&amp; <span class="hljs-keyword">this</span>.index()) {
          to = path.join(<span class="hljs-keyword">this</span>.filepath, <span class="hljs-string">'index'</span>);
        }

        <span class="hljs-keyword">return</span> active.relative(to);
      }
    },

    active: {
      deps: [<span class="hljs-string">'filepath'</span>],
      cache: <span class="hljs-literal">false</span>,
      fn: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.collection.active === <span class="hljs-keyword">this</span>.filepath;
      }
    }
  },

  serialize: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">var</span> res = <span class="hljs-keyword">this</span>.getAttributes({ props: <span class="hljs-literal">true</span> }, <span class="hljs-literal">true</span>);

    <span class="hljs-built_in">Object</span>.keys(<span class="hljs-keyword">this</span>._children).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(key)</span> </span>{
      res[key] = <span class="hljs-keyword">this</span>[key].serialize();
    }, <span class="hljs-keyword">this</span>);

    [
      <span class="hljs-string">'active'</span>
    ].forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(key)</span> </span>{
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>[key]) {
        res[key] = <span class="hljs-literal">true</span>;
      }
    }, <span class="hljs-keyword">this</span>);

    <span class="hljs-built_in">Object</span>.keys(<span class="hljs-keyword">this</span>._collections).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(key)</span> </span>{
      res[key] = <span class="hljs-keyword">this</span>[key].serialize();
    }, <span class="hljs-keyword">this</span>);
    <span class="hljs-keyword">return</span> res;
  },

  initialize: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">var</span> parents = [];

    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isRootDir) {
      <span class="hljs-keyword">var</span> parentPath = <span class="hljs-keyword">this</span>.dirname;
      <span class="hljs-keyword">var</span> parentModel = <span class="hljs-keyword">this</span>.collection ? <span class="hljs-keyword">this</span>.collection.get(parentPath) : <span class="hljs-literal">false</span>;

      parents = <span class="hljs-keyword">this</span>.dirname.split(<span class="hljs-string">'/'</span>);

      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.collection &amp;&amp; !parentModel) {
        <span class="hljs-keyword">this</span>.collection.add({
          filepath: parentPath,
          files: [<span class="hljs-keyword">this</span>]
        });
      }
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (parentModel) {
        parentModel.files.add(<span class="hljs-keyword">this</span>);
      }
    }


    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.collection) {
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">var</span> dirpath = <span class="hljs-keyword">this</span>.dirname + <span class="hljs-string">'/'</span> + <span class="hljs-keyword">this</span>.basename;

    <span class="hljs-keyword">this</span>.files.add(<span class="hljs-keyword">this</span>.collection.filter(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(model)</span> </span>{
      <span class="hljs-keyword">return</span> model.dirname === dirpath;
    }));

    <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>.collection, <span class="hljs-string">'add'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(model)</span> </span>{
      <span class="hljs-keyword">if</span> (model.dirname === dirpath) {
        <span class="hljs-keyword">this</span>.files.add(model);
      }
    });

    <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>.collection, <span class="hljs-string">'remove'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(model)</span> </span>{
      <span class="hljs-keyword">if</span> (model.dirname === dirpath) {
        <span class="hljs-keyword">this</span>.files.remove(model);
      }
    });
  },

  relative: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(obj)</span> </span>{
    <span class="hljs-keyword">var</span> destination;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> obj === <span class="hljs-string">'string'</span>) {
      destination = obj;
    }
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (obj <span class="hljs-keyword">instanceof</span> FileModel) {
      destination = obj.filepath;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> destination === <span class="hljs-string">'string'</span> ?
            path.relative(<span class="hljs-keyword">this</span>.isDir ? <span class="hljs-keyword">this</span>.filepath : <span class="hljs-keyword">this</span>.dirname, destination) :
            <span class="hljs-keyword">this</span>.toProjectDir;
  },

  inDir: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(dirname)</span> </span>{
    <span class="hljs-keyword">if</span> (dirname === <span class="hljs-keyword">this</span>.dirname) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.dirname.indexOf(dirname) === <span class="hljs-number">0</span>;
  },

  index: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(indexNames)</span> </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isFile) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-keyword">var</span> name = indexNames || <span class="hljs-keyword">this</span>.indexName || <span class="hljs-string">'README.md'</span>;
    <span class="hljs-keyword">var</span> names = <span class="hljs-built_in">Array</span>.isArray(name) ? name : [name];
    <span class="hljs-keyword">var</span> filepathPrefix = <span class="hljs-keyword">this</span>.isRootDir ? <span class="hljs-string">''</span> : (<span class="hljs-keyword">this</span>.filepath + <span class="hljs-string">'/'</span>);

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n <span class="hljs-keyword">in</span> names) {
      <span class="hljs-keyword">var</span> indexFilepath = filepathPrefix + names[n];
      <span class="hljs-keyword">var</span> model = <span class="hljs-keyword">this</span>.files.get(indexFilepath);

      <span class="hljs-keyword">if</span> (model) {
        <span class="hljs-keyword">return</span> model;
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }
});



<span class="hljs-keyword">var</span> FilesCollection = <span class="hljs-built_in">module</span>.exports = Collection.extend({
  model: FileModel,

  mainIndex: <span class="hljs-string">'filepath'</span>,

  indexes: [
    <span class="hljs-string">'dirname'</span>,
    <span class="hljs-string">'extname'</span>
  ],

  active: <span class="hljs-string">''</span>,

  basePath: <span class="hljs-string">''</span>,


  initialize: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(models, options)</span> </span>{
    options = options || {};

    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.active &amp;&amp; options.active) {
      <span class="hljs-keyword">this</span>.active = options.active;
    }

    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.basePath &amp;&amp; options.basePath) {
      <span class="hljs-keyword">this</span>.basePath = options.basePath;
    }
  },


  index: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(indexNames)</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'.'</span>).index(indexNames);
  },


  serialize: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">var</span> results = Collection.prototype.serialize.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    <span class="hljs-keyword">return</span> results.filter(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(model)</span> </span>{
      <span class="hljs-keyword">return</span> !!model;
    });
  },


  comparator: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(a, b)</span> </span>{
    <span class="hljs-keyword">if</span> (a.isDir !== b.isDir) {
      <span class="hljs-keyword">if</span> (a.isDir) { <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; }
      <span class="hljs-keyword">if</span> (b.isDir) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
    }
    <span class="hljs-keyword">return</span> a.basename &gt; b.basename;
  },


  filterBy: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(key, value, options)</span> </span>{
    <span class="hljs-keyword">var</span> picked = [];
    options = options || {};

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span><span class="hljs-params">(model)</span> </span>{
      <span class="hljs-keyword">if</span> (model[key] !== value) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      }

      picked.push(model.getId());
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }

    <span class="hljs-keyword">var</span> filtered = <span class="hljs-keyword">this</span>.filter(filter);

    <span class="hljs-keyword">if</span> (options.picked) {
      <span class="hljs-keyword">return</span> picked;
    }

    <span class="hljs-keyword">return</span> filtered;
  },


  filepaths: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(options)</span> </span>{
    options = options || {};
    <span class="hljs-keyword">var</span> files = <span class="hljs-keyword">this</span>
      .filter(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(model)</span> </span>{
        <span class="hljs-keyword">return</span> model.isFile &amp;&amp;
          (options.dirname ? model.dirname === options.dirname : <span class="hljs-literal">true</span>);
      })
      .map(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(model)</span> </span>{
        <span class="hljs-keyword">return</span> model.filepath;
      })
      .sort()
    ;
    <span class="hljs-keyword">return</span> files;
  },


  directories: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">var</span> result = [];
    <span class="hljs-keyword">this</span>.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(model)</span> </span>{
      <span class="hljs-keyword">if</span> (result.indexOf(model.dirname) &lt; <span class="hljs-number">0</span>) {
        result.push(model.dirname);
      }
    });
    <span class="hljs-keyword">return</span> result;
  },


  tree: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(from)</span> </span>{
    from = from || <span class="hljs-string">'.'</span>;

    <span class="hljs-keyword">var</span> dirModel = <span class="hljs-keyword">this</span>.get(from);
    <span class="hljs-keyword">if</span> (dirModel) {
      <span class="hljs-keyword">return</span> dirModel;
    }

    <span class="hljs-keyword">return</span> {
      filepath: from,
      files:    <span class="hljs-keyword">this</span>.filter(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(model)</span> </span>{
                  <span class="hljs-keyword">return</span> model.dirname === from;
                })
    };
  },


  setActive: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(active)</span> </span>{
    active = active || <span class="hljs-string">''</span>;
    <span class="hljs-keyword">if</span> (active !== <span class="hljs-keyword">this</span>.active) {
      <span class="hljs-keyword">this</span>.active = active || <span class="hljs-string">''</span>;
      <span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'active'</span>, active, <span class="hljs-keyword">this</span>);
    }
  },

  getActive: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.get(<span class="hljs-keyword">this</span>.active);
  }
});

FilesCollection.File = FileModel;

FilesCollection.Directory = DirectoryCollection;

FilesCollection.expand = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(arr)</span> </span>{
  <span class="hljs-keyword">return</span> arr.map(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(item)</span> </span>{
    <span class="hljs-keyword">return</span> { filepath: item };
  });
};
</code></pre></div></div>
  </div>


  <script src="../../assets/scripts/scripts.js"></script>
  <script>
  var config = {"files":["Gruntfile.js","README.md","lib/blocks-collection.js","lib/index.js","lib/rendering-utils.js","node_modules/ampersand-collection/README.md","node_modules/ampersand-collection/ampersand-collection.js","node_modules/ampersand-model/README.md","node_modules/ampersand-model/ampersand-model.js","node_modules/faceted-search/README.md","node_modules/faceted-search/index.js","node_modules/faceted-search/results.js","node_modules/faceted-search/styles.css","node_modules/files-collection/DOCUMENTATION.md","node_modules/files-collection/README.md","node_modules/files-collection/index.js","node_modules/files-collection/node.js","resources/test/README.md","resources/test/dir/README.md","resources/test/dir/sub/README.md","resources/themes/README.md","resources/themes/default/README.md","resources/themes/default/assets/scripts/scripts.src.js","resources/themes/default/assets/styles/styles.css","resources/themes/default/file.jst","resources/themes/default/navigation-item.jst","resources/themes/default/navigation.jst","tasks/gtfd.js"],"active":"node_modules/files-collection/index.js"};
  config.files = (config.files || []).map(function (filepath) {
    return { filepath: filepath };
  });
  config.el = document.body;
  new gtfd(config);
  </script>
</body>
</html>
